@page "/dummycheckout"

@using Microsoft.EntityFrameworkCore.Metadata.Internal
@using View.Components.Layout
@layout MainLayout
@inject LocalStorageService LocalStorage
@inject NavigationManager Navigation
<style>
    .logout-btn {
        background-color: transparent;
        border: 2px solid #1f1f1f;
        color: #1f1f1f;
        padding: 6px 16px;
        border-radius: 8px;
        transition: all 0.3s ease;
    }

    .logout-btn:hover {
        background-color: #1f1f1f;
        color: white;
    }
</style>
<nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm py-3">
    <div class="container-fluid d-flex justify-content-between align-items-center">

        <!-- Logo -->
        <a class="navbar-brand fw-bold fs-3 text-dark" href="/" style="margin-right: 30px;">
            BulkBase
        </a>

        <!-- Navigation Buttons -->
        <div class="d-flex align-items-center gap-2">
            <a class="nav-link custom-nav-link" href="/">Start</a>
            <a class="nav-link custom-nav-link" href="/products">Produkte</a>
        </div>

        <!-- Sign Out + Cart -->
        <div class="d-flex align-items-center gap-3">
            <button class="btn logout-btn fw-semibold" @onclick="Logout">Ausloggen</button>
            <a class="nav-link position-relative" href="/cart">
                <img src="images/warenkorb.jpg" alt="Cart" style="height: 30px;" />
            </a>
        </div>
    </div>
</nav>

<div class="container text-center mt-5">
    <h1 class="display-5 fw-bold mb-4">✅ Bestellung abgeschlossen</h1>
    <p class="fs-4">
        Automatisch bezahlt durch Kredit von der <strong>EZB</strong>,<br />
        deine Lieferung ist schon bald bei dir.<br /><br />
        <strong>Vielen Dank für deinen Einkauf!</strong>
    </p>
</div>
@code{
    
    private async Task Logout()
    {
        await LocalStorage.ClearUserData();
        Navigation.NavigateTo("/login", forceLoad: true);
    }
    private bool _initialized = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && !_initialized)
        {
            _initialized = true;

            var username = await LocalStorage.GetUsername();
            if (string.IsNullOrEmpty(username))
            {
                Navigation.NavigateTo("/login", forceLoad: true);
            }
        }
    }

}